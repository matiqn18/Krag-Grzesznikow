[gd_scene load_steps=22 format=3 uid="uid://bglwcmnv0tos4"]

[ext_resource type="Texture2D" uid="uid://c8box06e8u0dx" path="res://assets/images/skybox/skybox.webp" id="1_u2td5"]
[ext_resource type="Material" uid="uid://dphedafn76ry3" path="res://materials/room_walls.tres" id="2_lurqq"]
[ext_resource type="Material" uid="uid://dmli6l7x1k657" path="res://materials/table_top.tres" id="3_ma0xs"]
[ext_resource type="Material" uid="uid://cp3055l78att8" path="res://materials/table_leg.tres" id="4_e1egb"]
[ext_resource type="Script" uid="uid://ctb2eo3g6xxds" path="res://scripts/gameplay/camera_movement.gd" id="5_6f0r7"]
[ext_resource type="PackedScene" uid="uid://bvmkkrntcsbit" path="res://assets/models/humans/chciwy_andrzej/ChciwyAndrzejModel.glb" id="6_e1egb"]
[ext_resource type="Script" uid="uid://buafewbw8xf5h" path="res://scripts/managers/events_manager.gd" id="6_lurqq"]
[ext_resource type="AudioStream" uid="uid://csjq0bw3iye4s" path="res://assets/audio/sfx/loud_noises/loud_noise_1.wav" id="6_ryp8i"]
[ext_resource type="AudioStream" uid="uid://bidtw2y1i6krt" path="res://assets/audio/sfx/loud_noises/I_Can_See_You.wav" id="7_u2td5"]
[ext_resource type="Texture2D" uid="uid://c14f3c0wrybjp" path="res://assets/models/humans/chciwy_andrzej/ChciwyAndrzejModel_Eye_01000.png" id="8_lurqq"]
[ext_resource type="AudioStream" uid="uid://crd14hk0d5kg1" path="res://assets/audio/sfx/loud_noises/Demon_Speaking.wav" id="10_6f0r7"]

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_3t5kb"]
panorama = ExtResource("1_u2td5")

[sub_resource type="Sky" id="Sky_mw25s"]
sky_material = SubResource("PanoramaSkyMaterial_3t5kb")

[sub_resource type="Environment" id="Environment_2wmva"]
background_mode = 2
background_energy_multiplier = 0.6
sky = SubResource("Sky_mw25s")
sky_rotation = Vector3(0, -1.6371188, -3.1415927)
ambient_light_source = 3
glow_enabled = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ndn4p"]
albedo_color = Color(0.5132329, 0.5132329, 0.5132329, 1)

[sub_resource type="Animation" id="Animation_bw6k5"]
resource_name = "MoveSpotlight"
length = 11.0
tracks/0/type = "audio"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../AnomalyPlayer/MoveSpotlight/AudioStreamPlayer3D")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"clips": [{
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource("6_ryp8i")
}],
"times": PackedFloat32Array(0)
}
tracks/0/use_blend = true
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../AnomalyPlayer/MoveSpotlight/SpotLight3D2:rotation")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.73333335, 1.1, 1.6, 2.2333333, 2.8, 3.4333334, 4.233333, 5.4, 5.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 0,
"values": [Vector3(0, -1.097812, 0), Vector3(0, -1.4451326, 0), Vector3(0, -1.5062191, 0), Vector3(0, -1.4416419, 0), Vector3(0, -1.6336281, 0), Vector3(0, -1.7645279, 0), Vector3(0, -1.5149457, 0), Vector3(0, -2.0472713, 0), Vector3(0, -2.1694443, 0), Vector3(0, -1.1519173, 0)]
}

[sub_resource type="Animation" id="Animation_ma0xs"]
resource_name = "ISeeYou"
length = 5.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../DoorPivot:visible")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1, 2, 3, 4, 5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 0,
"values": [true, false, false, false, false, true]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../RoomBox/Table/TableTop:visible")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1, 2, 3, 4, 5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 0,
"values": [true, true, false, false, false, true]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("../AnomalyPlayer/ISeeYou/EyeTableTop:visible")
tracks/2/interp = 2
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1, 2, 3, 4, 5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 0,
"values": [false, false, true, true, true, false]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("../AnomalyPlayer/ISeeYou/EyeDoorPivot:visible")
tracks/3/interp = 2
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 1, 2, 3, 4, 5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 0,
"values": [false, true, true, true, true, false]
}
tracks/4/type = "audio"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("../AnomalyPlayer/ISeeYou/AudioStreamPlayer3D")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"clips": [{
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource("7_u2td5")
}],
"times": PackedFloat32Array(0)
}
tracks/4/use_blend = true

[sub_resource type="Animation" id="Animation_ryp8i"]
resource_name = "AndrzejWhispers"
length = 12.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("../Camera3D/AndrzejCamera:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1.5, 3, 4.5, 6, 8, 9.5, 11, 12),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 0,
"values": [Vector3(0, 4.5, 0), Vector3(0, 4.3, 0), Vector3(0, 4.1, 0), Vector3(0, 3.9, 0), Vector3(0, 3.7, 0), Vector3(0, 3.7, 0), Vector3(0, 4, 0), Vector3(0, 4.3, 0), Vector3(0, 4.5, 0)]
}
tracks/1/type = "audio"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../AnomalyPlayer/AndrzejSpeaking/AudioStreamPlayer3D")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"clips": [{
"end_offset": 0.0,
"start_offset": 0.0,
"stream": ExtResource("10_6f0r7")
}],
"times": PackedFloat32Array(0)
}
tracks/1/use_blend = true
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("../Camera3D/AndrzejCamera:visible")
tracks/2/interp = 2
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 11, 12),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [true, true, false]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_rurhu"]
_data = {
&"AndrzejSpeaking": SubResource("Animation_ryp8i"),
&"ISeeYou": SubResource("Animation_ma0xs"),
&"MoveSpotlight": SubResource("Animation_bw6k5")
}

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_e1egb"]
albedo_texture = ExtResource("8_lurqq")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_6f0r7"]
albedo_texture = ExtResource("8_lurqq")

[node name="AnomalyScene" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_2wmva")

[node name="DoorPivot" type="Node3D" parent="."]
transform = Transform3D(0.9999999, 0, 0, 0, 1, 0, 0, 0, 0.18862842, 3.0076213, -0.19011769, -1.3944383)

[node name="Door" type="CSGBox3D" parent="DoorPivot"]
transform = Transform3D(1, 0, -7.450581e-09, 0, 1, 0, 0, 0, 1, -0.058, 0, -3.772)
size = Vector3(0.06012574, 2.3697267, 7.5249023)
material = SubResource("StandardMaterial3D_ndn4p")

[node name="RoomBox" type="CSGCombiner3D" parent="."]
material_override = ExtResource("2_lurqq")

[node name="RoomBorders" type="CSGBox3D" parent="RoomBox"]
size = Vector3(6, 3, 6)

[node name="RoomInsideAir" type="CSGBox3D" parent="RoomBox"]
operation = 2
size = Vector3(5.8, 2.8, 5.8)

[node name="Window" type="CSGBox3D" parent="RoomBox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.95, 0.4, 0)
operation = 2
size = Vector3(0.2, 1.6, 4)

[node name="DoorSpace" type="CSGBox3D" parent="RoomBox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 0.18862844, 2.7863843, -0.19011769, -2.1040385)
operation = 2
size = Vector3(0.6710327, 2.3697267, 7.5249023)

[node name="Table" type="Node" parent="RoomBox"]

[node name="TableTop" type="CSGBox3D" parent="RoomBox/Table"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.4494629, 0)
material_override = ExtResource("3_ma0xs")
size = Vector3(2, 0.1, 1.5)

[node name="TableLeg" type="CSGCylinder3D" parent="RoomBox/Table"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.9, -0.9, 0.6)
material_override = ExtResource("4_e1egb")
radius = 0.05
height = 1.0

[node name="TableLeg2" type="CSGCylinder3D" parent="RoomBox/Table"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.9, -0.9, 0.6)
material_override = ExtResource("4_e1egb")
radius = 0.05
height = 1.0

[node name="TableLeg3" type="CSGCylinder3D" parent="RoomBox/Table"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.9, -0.9, -0.6)
material_override = ExtResource("4_e1egb")
radius = 0.05
height = 1.0

[node name="TableLeg4" type="CSGCylinder3D" parent="RoomBox/Table"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.9, -0.9, -0.6)
material_override = ExtResource("4_e1egb")
radius = 0.05
height = 1.0

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.13408893, 1.3720051)
script = ExtResource("5_6f0r7")
mouse_sensitivity = 0.003

[node name="AndrzejCamera" parent="Camera3D" instance=ExtResource("6_e1egb")]
transform = Transform3D(-0.9999999, 8.742277e-08, 0, -8.6094616e-08, -0.9848076, -0.17364818, -1.5180804e-08, -0.17364816, 0.9848077, 0, 4.5, 0)
visible = false

[node name="SpotLight3D" type="SpotLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.371139e-08, 1, 0, -1, -4.371139e-08, 0, 1.4126741, 0)
light_color = Color(0.7, 0.7, 0.7, 1)
light_energy = 4.0
light_specular = 0.0

[node name="AnomalyController" type="Node3D" parent="." node_paths=PackedStringArray("anomaly", "timer")]
script = ExtResource("6_lurqq")
anomaly = NodePath("../AnomalyPlayer")
timer = NodePath("../AnomalyTimer")

[node name="AnomalyPlayer" type="AnimationPlayer" parent="."]
root_node = NodePath("../AnomalyController")
libraries = {
&"": SubResource("AnimationLibrary_rurhu")
}

[node name="MoveSpotlight" type="Node3D" parent="AnomalyPlayer"]

[node name="SpotLight3D2" type="SpotLight3D" parent="AnomalyPlayer/MoveSpotlight"]
transform = Transform3D(0.45554495, 0, -0.8902128, 0, 1, 0, 0.8902128, 0, 0.45554495, -12.894454, 0.30394733, 0.0251261)
light_color = Color(1, 0, 0, 1)
light_energy = 16.0
shadow_enabled = true
spot_range = 100.0
spot_angle = 7.0

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="AnomalyPlayer/MoveSpotlight"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.886465, 0, 0)

[node name="ISeeYou" type="Node3D" parent="AnomalyPlayer"]

[node name="EyeTableTop" type="CSGBox3D" parent="AnomalyPlayer/ISeeYou"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.4494629, 0)
visible = false
material_override = SubResource("StandardMaterial3D_e1egb")
size = Vector3(2, 0.1, 1.5)

[node name="EyeDoorPivot" type="Node3D" parent="AnomalyPlayer/ISeeYou"]
transform = Transform3D(0.9999999, 0, 0, 0, 1, 0, 0, 0, 0.18862842, 3.0076213, -0.19011769, -1.3944383)
visible = false

[node name="Door" type="CSGBox3D" parent="AnomalyPlayer/ISeeYou/EyeDoorPivot"]
transform = Transform3D(1, 0, -7.450581e-09, 0, 1, 0, 0, 0, 1, -0.058, 0, -3.772)
material_override = SubResource("StandardMaterial3D_6f0r7")
size = Vector3(0.06012574, 2.3697267, 7.5249023)
material = SubResource("StandardMaterial3D_ndn4p")

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="AnomalyPlayer/ISeeYou"]

[node name="AndrzejSpeaking" type="Node3D" parent="AnomalyPlayer"]

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="AnomalyPlayer/AndrzejSpeaking"]

[node name="AnomalyTimer" type="Timer" parent="."]
wait_time = 12.0
autostart = true

[connection signal="timeout" from="AnomalyTimer" to="AnomalyController" method="trigger_anomaly_time"]
